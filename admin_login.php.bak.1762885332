<?php
require __DIR__ . '/includes.php';

$pageTitle = 'Admin Login';

$error = null;
$next = $_GET['next'] ?? '/admin_panel.php';

if (is_admin_logged_in()) {
    redirect($next);
}

if (is_post()) {
    $password = $_POST['password'] ?? '';
    if (attempt_admin_login($password)) {
        redirect($next);
    } else {
        $error = 'Invalid admin password.';
    }
}

@include __DIR__ . '/templates/HeaderTemplate.php';
?>
<section class="max-w-md mx-auto">
  <h1 class="text-2xl font-bold mb-4">Admin Login</h1>

  <?php if ($error): ?>
    <div class="mb-4 rounded border border-rose-700/60 bg-rose-900/40 px-4 py-3 text-rose-100">
      <?= h($error) ?>
    </div>
  <?php endif; ?>

  <form method="post" class="space-y-4">
    <div>
      <label class="block text-sm mb-1" for="password">Password</label>
      <input
        id="password"
        name="password"
        type="password"
        class="w-full rounded border border-slate-700 bg-slate-900 px-3 py-2"
        required
      >
    </div>
    <button
      type="submit"
      class="rounded-lg bg-sky-500 px-4 py-2 font-semibold text-slate-900 hover:bg-sky-400"
    >
      Log in
    </button>
  </form>
</section>
<?php @include __DIR__ . '/templates/FooterTemplate.php'; ?>
